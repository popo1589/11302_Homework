學期報告(醫療安全議題：桃竹苗區域)
====

# 壹、緣起目的

* 本學期課程涵蓋紅隊（滲透測試）與藍隊（資訊安全）兩大資安領域，透過貫穿網路攻防完整流程的方式，培養學生兼顧理論研討與實務操作能力。
* 本報告要求同學以假想政府健康醫療監管單位角度，選擇桃竹苗區域之醫療安全議題，依序進行紅隊及藍隊之策略分析、任務調度及戰術執行等各階段作為，以體現同學學習成果及對於醫療資安攻防全貌的理解與應用能力。

註：報告引用之資訊皆為公開文獻或假設情境，僅供學生練習醫療資安分析作業使用，不適用實務應用。

# 貳、相關資訊

## 一、資安角色

* **紅隊（Red Team）**：扮演攻擊者角色，從外部與內部兩面向測試醫療資訊系統弱點，評估醫院網路、醫療IoT與影像系統等之防禦能力。
* **藍隊（Blue Team）**：負責系統防護、持續監控與事件回應，建置醫療網路與資料保護架構並研擬應變計畫。

## 二、結構性思維

依照美國 NIST SP 800-53 與 IEC 80001-1 醫療設備網路安全標準，思維可分為三層：
* **策略分析（Strategy）**：定義醫療安全整體目標與優先順序，並與衛福部法規及醫院風險管理政策對齊。
* **任務調度（Operation）**：規劃紅隊滲透與藍隊防護資源配置、時間表與執行步驟，確保各醫院協同作業。
* **戰術執行（Tactics）**：選擇具體攻擊工具與防護技術，細化醫療系統攻防細節與執行標準。

本課程基於上述多層次思維方法論，亦將紅、藍隊作業，比照拆解為可管理之三層結構，具有下列優勢：  
- **一致性**：與醫療院所資安治理架構接軌，幫助同學快速銜接實務環境。  
- **靈活性**：面對動態醫療場景時，可快速調整層級焦點，從整體策略到設備細節均可掌控。  
- **協作性**：促進紅隊、藍隊、醫院管理層及法規單位之間之溝通與協同。

本報告即依此架構，分別展開紅隊與藍隊兩大部分，確保由宏觀策略層面，逐步走向戰術執行實操作業。

# 參、紅隊滲透測試

**假想背景**

您為政府健康醫療資安監管單位新進人員，依上級要求須針對「桃竹苗區域」三家重點醫院之醫療資訊安全進行大規模滲透測試演練，三家醫院分別為桃園長庚紀念醫院、新竹臺大分院新竹醫院及苗栗大千綜合醫院。請依序從策略角度分析駭客潛在攻擊目標、規劃滲透測試任務做法，及實作滲透戰術執行範例。

## 一、策略分析面

### (一) 策略目的

* 依上級要求，本章以「桃竹苗區域」醫療資訊安全為目標，進行駭客潛在攻擊目標分析，以作為後續滲透測試任務規劃之參據。
* 本節將以確保醫療服務可用性、患者資料機密性與系統完整性為核心目標，分析可能遭駭客攻擊之關聯基礎設施。

### (二) 參考資訊

#### 駭客思維分析

駭客常利用最小成本、最高影響力原則侵入醫院系統，常見手段包括：  
1. **OSINT（公開情報蒐集）**：蒐集醫院域名、公開 API、醫療IoT廠商資訊。  
2. **社交工程**：透過假冒院內郵件或簡訊誘導，竊取醫師護理人員登入憑證。  
3. **自動化掃描**：使用 Nmap、OpenVAS 掃描電子病歷（EHR）、PACS 影像系統漏洞。  
4. **橫向移動**：利用 EternalBlue、Pass-the-Hash 等技巧，擴大入侵範圍。  

#### 潛在威脅來源

* **醫療APT**：如 Maze、Ryuk，專注於醫療機構網路勒索與資料竊取。  
* **犯罪集團**：透過加密醫療資料進行勒索，影響救護流程。  
* **業餘駭客**：測試或炫技型威脅，可能導致醫療設備異常。  

#### 醫療資訊系統簡介

現代醫療資訊系統通常由以下幾個關鍵項目組成：  
1. **電子病歷系統（EHR）**：集中管理患者診療紀錄、病史、處方與檢驗結果。  
2. **影像儲存與傳輸系統（PACS）**：儲存與傳輸放射、超音波等醫療影像。  
3. **醫療IoT裝置**：如心電監護、輸液泵、呼吸機等，提供即時生理數據監測。  
4. **醫院網路與接口**：連接各系統與外部醫療資訊交換（如 HL7、FHIR）。  

上述項目容易遭駭客威脅包括：  
1. **電子病歷系統（EHR）**：駭客可能透過 SQL 注入或憑證外洩取得患者敏感資料，影響資料機密性與完整性。  
2. **影像儲存與傳輸系統（PACS）**：駭客可能入侵伺服器竊取或篡改醫療影像，干擾診斷並影響醫療品質。  
3. **醫療IoT裝置**：駭客可能利用預設密碼或韌體漏洞入侵裝置，造成生理數據錯誤或設備失控，進而危及患者安全。  
4. **醫院網路與接口**：駭客可能透過未加密的 HL7/FHIR 傳輸截取或注入惡意資料，破壞跨院資料交換流程。  

## 三、關聯分析評估

### (一) 桃園長庚紀念醫院

* **日均門診量**：約 5,000 人次  
* **主要系統**：Cerner EHR、GE Healthcare PACS、醫療 IoT 監控平台  
* **攻擊價值分析**：高——存有大量患者個資與影像資料，若被入侵將嚴重影響診療安全與院內運作  
* **攻擊難度分析**：中高——院內網段隔離與多重認證機制增加滲透難度  
  - **攻擊面**：醫療 IoT 感測器、影像儲存伺服器可能存在弱預設密碼或未限制管理介面存取  
  - **技術性質**：公開掃描、弱密碼爆破、社交工程、EHR SQL 注入測試  

### (二) 新竹臺大分院新竹醫院

* **日均急診量**：約 300 人次；住院床位 700 床  
* **主要系統**：HIS（Hospital Information System）、Philips IntelliVue 監護系統、HL7 通訊接口伺服器  
* **攻擊價值分析**：中——影響急診與住院流程，但資料總量相對少於長庚  
* **攻擊難度分析**：中——HL7 通訊常未全面加密，易遭中間人攻擊  
  - **攻擊面**：HL7 接口若未強制 TLS，可能被竊聽或注入惡意資料  
  - **技術性質**：MITM 攔截、HL7 資料注入、遠端程式碼執行  

### (三) 苗栗大千綜合醫院

* **日均門急診量**：約 2,000 人次  
* **主要系統**：Allscripts EHR、Siemens 醫療影像網路、邊緣運算 IoT 裝置  
* **攻擊價值分析**：中高——遠端醫療服務與邊緣 IoT 裝置擴大攻擊面  
* **攻擊難度分析**：高——需結合 IoT 韌體漏洞與跨網段滲透技巧  
  - **攻擊面**：邊緣 IoT 裝置常用預設憑證；影像伺服器可能因補丁延遲存在已知漏洞  
  - **技術性質**：IoT 憑證猜測、影像伺服器漏洞利用  

### (四) 攻擊效益與成本評估

根據價值與難度評估，潛在優先受攻擊順序如下：  
1. **桃園長庚紀念醫院**——高價值、中高難度，潛在衝擊最大  
2. **苗栗大千綜合醫院**——中高價值、高難度，遠距醫療風險顯著  
3. **新竹臺大分院新竹醫院**——中等價值、中等難度，HL7 通訊為主要弱點  

### (五) 小結

本章以「桃竹苗區域」三家重點醫院為例，分析其醫療資訊系統之攻擊價值與難度，得出潛在攻擊目標依序為「桃園長庚紀念醫院」、「苗栗大千綜合醫院」與「新竹臺大分院新竹醫院」，可作為後續滲透測試之參考。

## 二、任務調度面

### (一) 任務目的

參據策略分析結果，將以「桃園長庚紀念醫院」為滲透測試演練目標。本章並參考 MITRE ATT&CK for Enterprise 框架，規劃醫療資安滲透測試任務做法，說明各階段作業重點，並提供具體時間表與成果指標。

### (二) 參考資訊

#### 駭客方法論

Cyber Kill Chain 由 Lockheed Martin 於 2011 年提出，分為以下七個階段：  
1. **偵查**（Reconnaissance）：收集目標系統公開資訊，如醫院域名、HL7/FHIR 端點、IoT 裝置。  
2. **整備**（Weaponization）：製作針對醫療系統的惡意程式或工具模組。  
3. **派送**（Delivery）：透過釣魚郵件、物聯網固件更新漏洞或內網憑證竊取傳送惡意程式。  
4. **利用**（Exploitation）：執行惡意程式以取得初步存取權限。  
5. **安裝**（Installation）：在 EHR、PACS 或監護系統上安裝後門以維持長期存取。  
6. **指揮控制**（Command and Control）：建立與攻擊者伺服器之持續通道，偵測並繞過醫院防護。  
7. **攻擊破壞**（Actions on Objectives）：竊取患者資料、篡改影像或癱瘓關鍵醫療設備。  

若簡化為四階段：  
1. **情報蒐集**（Reconnaissance）  
2. **戰具整備**（Weaponization）  
3. **滲透潛伏**（Penetration）  
4. **攻擊破壞**（Actions on Objectives）  

### (三) 任務規劃

#### 作業規劃

1. **情報蒐集**  
   - 使用時間：2 週  
   - 作業內容：  
     - 使用 Shodan、Censys 搜尋醫院公開 IoT 裝置與 DICOM 伺服器。  
     - 以 Nmap、Masscan 掃描內部網段開放埠號與服務。  
   - 作業產出：  
     * **目標資源清單**  
       - EHR、PACS、HL7/FHIR 伺服器 IP 與版本資訊  
       - 生理監測儀、輸液泵等 IoT 裝置型號與管理介面  
     * **潛在人員清單**  
       - 系統管理員、醫療資訊工程師、臨床醫師帳號名稱  

2. **戰具整備**  
   - 使用時間：1 週  
   - 作業內容：  
     - 準備專用 Kali Linux 篩選模組，安裝 Metasploit、Cobalt Strike。  
     - 撰寫自動化腳本，針對 HL7/FHIR API 進行驗證繞過。  
   - 作業產出：  
     * **工具清單**：Metasploit 模組、Cobalt Strike Beacon、Python HL7 測試腳本  
     * **測試平台**：虛擬化 EHR、PACS 與 IoT 模擬環境  

3. **滲透潛伏**  
   - 使用時間：2 週  
   - 作業內容：  
     - 執行 SQLi、XSS、憑證爆破，取得初步權限。  
     - 橫向移動至 PACS 或監護系統，部署持久性後門。  
   - 作業產出：  
     * **入侵報告**：成功入侵的系統清單、獲取之憑證  
     * **後門配置**：已部署的 C2 Beacon 列表與存活測試結果  

4. **攻擊破壞**  
   - 使用時間：1 週  
   - 作業內容：  
     - 模擬患者資料竊取與影像篡改，評估對醫療流程影響。  
     - 以流量回放或功能測試驗證後門穩定性。  
   - 作業產出：  
     * **模擬攻擊報告**：攻擊流程圖、影響評估  
     * **改進建議**：對應防護與偵測措施  

#### 人力與工具清單

* **人力**：  
  - 測試領隊 1 名：統籌測試規劃與協調  
  - 資安工程師 2 名：負責滲透測試與工具開發  
  - 臨床顧問 1 名：協助評估醫療影響  
* **硬體**：  
  - 高階筆電 3 台：Intel i7、32GB RAM、1TB SSD  
* **軟體**：  
  - Kali Linux 2025.1、Metasploit 6.x、Cobalt Strike 4.x、Python 3.10  

#### 成果度量指標

1. **漏洞識別率**：至少涵蓋 90% 已知 CWE-89、CWE-79 類漏洞  
2. **入侵成功率**：取得初步或更高權限之系統比例 ≥ 80%  
3. **攻擊影響評估**：模擬資料竄改後的診療流程中斷時間  

### (五) 小結

本章依 Cyber Kill Chain 及 MITRE ATT&CK 方法論，將滲透測試分為四階段，並針對桃園長庚紀念醫院提供具體時間表與成果指標，確保測試可管理、可度量。  

## 三、戰術執行面

本節說明紅隊在醫療環境中使用之常見實務技術。

### (一) 網路情蒐

* 使用 Shodan API 自動化搜尋醫院公開的 DICOM/PACS 伺服器及醫療 IoT 裝置。  
* 透過 `dig` + `DNSmap` 完成子域名枚舉，找出 HIS、EHR、FHIR 服務域名。  
* 資料整理：將掃描與蒐集結果匯入 Elasticsearch，建立索引以便後續威脅分析。

### (二) 戰具整備

* 部署 Kali Linux 2025.1：安裝常用滲透測試套件並載入醫療專用模組。  
* 安裝並配置 Cobalt Strike 4.x：建立 3 個 Beacon 標籤，模擬針對 EHR 與 PACS 的長期 C2 通信。  
* 安裝其他工具：Hydra（爆破醫院管理系統帳密）、Nmap v7.93（內網掃描）、Metasploit 6.x（模組化攻擊）、Impacket v0.9.28（Kerberos 與 SMB 利用）。

### (三) 滲透測試操作

1. **外部入口測試**  
   - 使用 SQLmap v1.7.4 自動化檢測 HIS/EHR 系統可能的 SQL 注入漏洞，搭配 Burp Suite Pro 進行手動業務流程測試。  
2. **內部主機橫移**  
   - 執行 Kerberoasting（Impacket）對醫院 AD 服務取得 TGS，並使用 Rubeus 進一步提升權限。  
3. **後門部署**  
   - 在 PACS 或監護系統主機部署 Meterpreter，並以 Obfuscator 隱蔽 shellcode，確保持久化存取。

### (四) 模擬攻擊活動

* **患者資料竊取演練**：模擬批次匯出 EHR 中之病歷資料，分析資料流向與存取記錄。  
* **醫療影像篡改測試**：下載 PACS 影像並注入偽造影像標記，驗證影像完整性檢測機制。  
* **IoT 設備操控**：模擬操控生理監測儀或輸液泵，驗證臨床監控團隊偵測與反應速度。  
* **系統癱瘓模擬**：關閉 HL7/FHIR 接口服務，觀察醫護人員及 IT 團隊的故障回復流程。

# 肆、藍隊資安防護

**假想背景**  
您的紅隊測試規劃深受長官肯定，並希望您從資安防護角度，同樣以「桃竹苗區域」三家重點醫院（桃園長庚紀念醫院、新竹臺大分院新竹醫院、苗栗大千綜合醫院）之醫療資訊安全為目標，提供整體資訊安全作業規劃。請依序從策略治理角度進行資安風險分析、規劃資安管理任務做法，及實作防護戰術執行範例。

## 一、策略分析面（治理目的）

### (一) 策略目的
* 依上級要求，本章以「桃竹苗區域」三家醫院之醫療資訊安全為核心，訂定資安防護目標，作為後續資安管理之依據。  
* 本節將以確保患者資料機密性、系統完整性及醫療服務可用性為優先，分析應優先達成之防護項目。

### (二) 參考資訊

#### 資安治理概念  
資安治理係指組織在資訊安全方面之管理與控制，依據醫療法規（如醫療器材資訊系統安全指引）、HIPAA 原則及 ISO 27001 要求，訂定並落實保護措施，以維護醫療資訊資產之機密性、完整性與可用性。

#### 醫療資訊系統簡介  
(同前節「醫療資訊系統簡介」)

### (三) 關聯分析評估

#### 三家醫院設施概況  
- **桃園長庚紀念醫院**：Cerner EHR、GE PACS、醫療 IoT 平台  
- **新竹臺大分院新竹醫院**：HIS、Philips 監護系統、HL7 接口  
- **苗栗大千綜合醫院**：Allscripts EHR、Siemens 影像網絡、邊緣 IoT  

#### 防護目標訂定  
依據病歷數量、影像存取頻率及 IoT 裝置影響度，訂定下列防護目標：  
1. **病歷管理系統（EHR/HIS）**：確保機密性與完整性，防範未授權讀取與竄改。  
2. **醫療影像系統（PACS）**：確保可用性，避免影像遺失或遭竄改。  
3. **醫療 IoT 設備**：確保設備韌性與通訊安全，防止偽造數據與遠端操控。  

### (四) 小結  
本章以「桃竹苗區域」三家醫院為例，訂定病歷系統、影像系統及 IoT 設備之防護目標，為後續防護任務調度及戰術執行提供方向。

## 二、任務調度面

### (一) 任務目的  
依據策略分析結果，需同時防護三家醫院之病歷系統、影像系統及 IoT 設備安全；本章擇「桃園長庚紀念醫院 EHR 系統」為範例，規劃資安防護作為，說明各階段作業重點並提供時間表與成果指標。

### (二) 參考資訊

#### 防護方法論  
採用 NIST Cybersecurity Framework 四階段模型：  
1. **識別（Identify）**：資產盤點、風險評估  
2. **防護（Protect）**：身份管理、存取控制、加密、防火牆  
3. **偵測與響應（Detect & Respond）**：SIEM、行為分析、事件通報  
4. **恢復（Recover）**：備份復原、SOP 演練  

### (三) 任務規劃

#### 作業規劃

1. **識別盤點**  
   - 時間：1 週  
   - 內容：  
     * 完成 EHR、PACS、IoT 裝置及網路資產清單  
     * 繪製邏輯網路與資料流程圖  
     * 風險評估報告  

2. **防護設置**  
   - 時間：4 週  
   - 內容：  
     * 部署多重認證（MFA）於 EHR 與管理介面  
     * 啟用資料庫加密與傳輸通道 TLS  
     * 配置醫療專用防火牆、網段隔離  
   - 驗收指標：  
     * MFA 啟用率 100%  
     * 通訊加密符合 TLS 1.2 以上  

3. **偵測與響應**（持續進行）  
   - 內容：  
     * SIEM 設定關鍵事件告警（異常登入、資料匯出）  
     * 定期分析日誌與異常行為  
     * 建立即時通報與應變流程  
   - 驗收指標：  
     * 平均事件偵測時間 <10 分鐘  
     * 平均事件回應時間 <30 分鐘  

4. **恢復驗證**  
   - 時間：每季演練  
   - 內容：  
     * 冷備/熱備切換測試  
     * 資料庫與檔案系統復原  
   - 驗收指標：  
     * RTO ≤ 2 小時  
     * RPO ≤ 15 分鐘  

#### 人力與工具清單

* **人力**：  
  - 資安主管 1 名、系統管理員 2 名、IT 支援人員 2 名  
* **軟硬體**：  
  - SIEM 平台、EDR/UEBA、HSM 加密模組、醫療專用防火牆  

#### 成果度量指標

1. EHR 系統異常登入偵測率 ≥ 95%  
2. 資料外洩事件 0 件  
3. 恢復演練成功率 100%  

### (四) 小結  
本章結合 NIST CSF 四階段方法論與醫療專屬防護措施，為桃園長庚紀念醫院 EHR 系統提供可量化、可追蹤之資安管理任務規劃。

## 三、戰術執行面

本節說明藍隊在醫療環境中使用之常見防護技術。

### (一) 識別盤點  
* 使用 Nmap v7.93 與 Nessus 掃描內部網段，匯出資產報告。  
* 建立 CMDB，標註系統分類與風險等級。

### (二) 防護設置  
* 部署 MFA 與 RBAC，限制 EHR/PACS 管理介面存取。  
* 啟用全磁碟加密及傳輸 TLS，確保資料在儲存與傳輸過程加密。  
* 配置醫療專用防火牆策略，隔離 IoT 與臨床網段。

### (三) 偵測與響應  
* 建立 SIEM 規則：異常登入、資料匯出、IoT 異常流量即時告警。  
* 部署 EDR/UEBA：監測主機行為並觸發調查工單。  
* 啟動資安事件協調小組：確保跨部門溝通與緊急應變。

### (四) 災後復原  
* 定期備份 EHR 資料庫至異地，並驗證恢復流程。  
* 每季演練冷備/熱備切換，檢視 SOP 完整性。  
* 建立復原報告，包含 RTO/RPO 實測結果與改進建議。

# 伍、結論

本報告依照多層次 S/O/T 架構，從紅隊對桃園長庚紀念醫院、新竹臺大分院新竹醫院及苗栗大千綜合醫院之醫療資訊系統滲透測試，到藍隊整體資安防護治理，結合公開文獻、醫療資安標準（如 NIST CSF、ISO 27001、醫療法規）與實務工具，完整展示桃竹苗區域醫療機構攻防流程。  

報告涵蓋以下重點：  
1. **策略層面**：明確訂定病歷管理系統、影像系統及醫療 IoT 等資安防護目標，並對應醫療法規與業界標準。  
2. **任務層面**：依 Cyber Kill Chain 與 MITRE ATT&CK 方法論，規劃紅隊滲透測試與 NIST CSF 四階段防護任務，提供時間表、成果指標及人力、工具需求。  
3. **戰術層面**：詳細列出紅隊網路情蒐、戰具整備、滲透操作與模擬攻擊活動，以及藍隊識別盤點、防護設置、偵測響應與災後復原之技術作法。  

未來優化建議：  
- **定期演練**：每季進行紅藍隊對抗演練，驗證防護效能與回應流程。  
- **基礎架構升級**：落實多重認證、加密通道與網段隔離，並更新醫療 IoT 固件與系統補丁。  
- **常態化測試**：將醫療資訊系統滲透測試納入年度資安計畫，確保風險持續受控。  

透過上述建議，可進一步強化桃竹苗區域三家醫院醫療資訊系統之資安韌性與持續營運能力，為學術研究與產業實務提供寶貴參考。  



